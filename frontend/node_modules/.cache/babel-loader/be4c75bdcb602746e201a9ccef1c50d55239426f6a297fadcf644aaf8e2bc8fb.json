{"ast":null,"code":"let cachedVoices = [];\nfunction refreshVoices() {\n  try {\n    const synth = window.speechSynthesis;\n    if (!synth) return [];\n    const voices = synth.getVoices();\n    if (voices && voices.length) cachedVoices = voices;\n    return cachedVoices;\n  } catch (_) {\n    return [];\n  }\n}\n\n// Public: return current voices (after hydration)\nexport function listVoices() {\n  const voices = refreshVoices();\n  // Some browsers populate voices asynchronously; attach a one-time listener\n  if (!voices.length && window.speechSynthesis) {\n    window.speechSynthesis.onvoiceschanged = () => {\n      cachedVoices = window.speechSynthesis.getVoices() || [];\n    };\n  }\n  return cachedVoices;\n}\n\n// Map simple language code to BCP-47 variants commonly available\nfunction resolveLangCode(lang) {\n  switch (lang) {\n    case 'hi':\n    case 'hi-IN':\n      return 'hi-IN';\n    case 'te':\n    case 'te-IN':\n      return 'te-IN';\n    case 'ta':\n    case 'ta-IN':\n      return 'ta-IN';\n    default:\n      return 'en-IN';\n  }\n}\nfunction findBestVoice(lang) {\n  const code = resolveLangCode(lang);\n  const voices = refreshVoices();\n  // Exact lang match\n  let v = voices.find(x => x.lang === code);\n  if (v) return v;\n  // Starts with match e.g. hi vs hi-IN\n  v = voices.find(x => x.lang && x.lang.toLowerCase().startsWith(code.slice(0, 2)));\n  if (v) return v;\n  // Fallback Indian English\n  v = voices.find(x => x.lang === 'en-IN');\n  if (v) return v;\n  // Any English fallback\n  return voices.find(x => (x.lang || '').startsWith('en')) || null;\n}\nexport function speak(text, lang = 'en-IN') {\n  try {\n    const synth = window.speechSynthesis;\n    if (!synth) return;\n    const utter = new SpeechSynthesisUtterance(text);\n    utter.lang = resolveLangCode(lang);\n    const voice = findBestVoice(lang);\n    if (voice) utter.voice = voice;\n    synth.cancel();\n    synth.speak(utter);\n  } catch (_) {}\n}\nexport function listen(onResult, onError) {\n  try {\n    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;\n    if (!SpeechRecognition) {\n      onError && onError(new Error('Speech recognition not supported'));\n      return () => {};\n    }\n    const recognition = new SpeechRecognition();\n    recognition.lang = 'en-IN';\n    recognition.continuous = false;\n    recognition.interimResults = false;\n    recognition.onresult = e => {\n      const transcript = e.results[0][0].transcript;\n      onResult && onResult(transcript);\n    };\n    recognition.onerror = e => onError && onError(e);\n    recognition.start();\n    return () => recognition.stop();\n  } catch (e) {\n    onError && onError(e);\n    return () => {};\n  }\n}","map":{"version":3,"names":["cachedVoices","refreshVoices","synth","window","speechSynthesis","voices","getVoices","length","_","listVoices","onvoiceschanged","resolveLangCode","lang","findBestVoice","code","v","find","x","toLowerCase","startsWith","slice","speak","text","utter","SpeechSynthesisUtterance","voice","cancel","listen","onResult","onError","SpeechRecognition","webkitSpeechRecognition","Error","recognition","continuous","interimResults","onresult","e","transcript","results","onerror","start","stop"],"sources":["C:/Users/Bharg/OneDrive/Desktop/Digital literacy/frontend/src/services/voice.js"],"sourcesContent":["let cachedVoices = [];\n\nfunction refreshVoices() {\n  try {\n    const synth = window.speechSynthesis;\n    if (!synth) return [];\n    const voices = synth.getVoices();\n    if (voices && voices.length) cachedVoices = voices;\n    return cachedVoices;\n  } catch (_) {\n    return [];\n  }\n}\n\n// Public: return current voices (after hydration)\nexport function listVoices() {\n  const voices = refreshVoices();\n  // Some browsers populate voices asynchronously; attach a one-time listener\n  if (!voices.length && window.speechSynthesis) {\n    window.speechSynthesis.onvoiceschanged = () => {\n      cachedVoices = window.speechSynthesis.getVoices() || [];\n    };\n  }\n  return cachedVoices;\n}\n\n// Map simple language code to BCP-47 variants commonly available\nfunction resolveLangCode(lang) {\n  switch (lang) {\n    case 'hi':\n    case 'hi-IN':\n      return 'hi-IN';\n    case 'te':\n    case 'te-IN':\n      return 'te-IN';\n    case 'ta':\n    case 'ta-IN':\n      return 'ta-IN';\n    default:\n      return 'en-IN';\n  }\n}\n\nfunction findBestVoice(lang) {\n  const code = resolveLangCode(lang);\n  const voices = refreshVoices();\n  // Exact lang match\n  let v = voices.find(x => x.lang === code);\n  if (v) return v;\n  // Starts with match e.g. hi vs hi-IN\n  v = voices.find(x => x.lang && x.lang.toLowerCase().startsWith(code.slice(0,2)));\n  if (v) return v;\n  // Fallback Indian English\n  v = voices.find(x => x.lang === 'en-IN');\n  if (v) return v;\n  // Any English fallback\n  return voices.find(x => (x.lang || '').startsWith('en')) || null;\n}\n\nexport function speak(text, lang = 'en-IN') {\n  try {\n    const synth = window.speechSynthesis;\n    if (!synth) return;\n    const utter = new SpeechSynthesisUtterance(text);\n    utter.lang = resolveLangCode(lang);\n    const voice = findBestVoice(lang);\n    if (voice) utter.voice = voice;\n    synth.cancel();\n    synth.speak(utter);\n  } catch (_) {}\n}\n\nexport function listen(onResult, onError) {\n  try {\n    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;\n    if (!SpeechRecognition) {\n      onError && onError(new Error('Speech recognition not supported'));\n      return () => {};\n    }\n    const recognition = new SpeechRecognition();\n    recognition.lang = 'en-IN';\n    recognition.continuous = false;\n    recognition.interimResults = false;\n    recognition.onresult = (e) => {\n      const transcript = e.results[0][0].transcript;\n      onResult && onResult(transcript);\n    };\n    recognition.onerror = (e) => onError && onError(e);\n    recognition.start();\n    return () => recognition.stop();\n  } catch (e) {\n    onError && onError(e);\n    return () => {};\n  }\n}"],"mappings":"AAAA,IAAIA,YAAY,GAAG,EAAE;AAErB,SAASC,aAAaA,CAAA,EAAG;EACvB,IAAI;IACF,MAAMC,KAAK,GAAGC,MAAM,CAACC,eAAe;IACpC,IAAI,CAACF,KAAK,EAAE,OAAO,EAAE;IACrB,MAAMG,MAAM,GAAGH,KAAK,CAACI,SAAS,CAAC,CAAC;IAChC,IAAID,MAAM,IAAIA,MAAM,CAACE,MAAM,EAAEP,YAAY,GAAGK,MAAM;IAClD,OAAOL,YAAY;EACrB,CAAC,CAAC,OAAOQ,CAAC,EAAE;IACV,OAAO,EAAE;EACX;AACF;;AAEA;AACA,OAAO,SAASC,UAAUA,CAAA,EAAG;EAC3B,MAAMJ,MAAM,GAAGJ,aAAa,CAAC,CAAC;EAC9B;EACA,IAAI,CAACI,MAAM,CAACE,MAAM,IAAIJ,MAAM,CAACC,eAAe,EAAE;IAC5CD,MAAM,CAACC,eAAe,CAACM,eAAe,GAAG,MAAM;MAC7CV,YAAY,GAAGG,MAAM,CAACC,eAAe,CAACE,SAAS,CAAC,CAAC,IAAI,EAAE;IACzD,CAAC;EACH;EACA,OAAON,YAAY;AACrB;;AAEA;AACA,SAASW,eAAeA,CAACC,IAAI,EAAE;EAC7B,QAAQA,IAAI;IACV,KAAK,IAAI;IACT,KAAK,OAAO;MACV,OAAO,OAAO;IAChB,KAAK,IAAI;IACT,KAAK,OAAO;MACV,OAAO,OAAO;IAChB,KAAK,IAAI;IACT,KAAK,OAAO;MACV,OAAO,OAAO;IAChB;MACE,OAAO,OAAO;EAClB;AACF;AAEA,SAASC,aAAaA,CAACD,IAAI,EAAE;EAC3B,MAAME,IAAI,GAAGH,eAAe,CAACC,IAAI,CAAC;EAClC,MAAMP,MAAM,GAAGJ,aAAa,CAAC,CAAC;EAC9B;EACA,IAAIc,CAAC,GAAGV,MAAM,CAACW,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACL,IAAI,KAAKE,IAAI,CAAC;EACzC,IAAIC,CAAC,EAAE,OAAOA,CAAC;EACf;EACAA,CAAC,GAAGV,MAAM,CAACW,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACL,IAAI,IAAIK,CAAC,CAACL,IAAI,CAACM,WAAW,CAAC,CAAC,CAACC,UAAU,CAACL,IAAI,CAACM,KAAK,CAAC,CAAC,EAAC,CAAC,CAAC,CAAC,CAAC;EAChF,IAAIL,CAAC,EAAE,OAAOA,CAAC;EACf;EACAA,CAAC,GAAGV,MAAM,CAACW,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACL,IAAI,KAAK,OAAO,CAAC;EACxC,IAAIG,CAAC,EAAE,OAAOA,CAAC;EACf;EACA,OAAOV,MAAM,CAACW,IAAI,CAACC,CAAC,IAAI,CAACA,CAAC,CAACL,IAAI,IAAI,EAAE,EAAEO,UAAU,CAAC,IAAI,CAAC,CAAC,IAAI,IAAI;AAClE;AAEA,OAAO,SAASE,KAAKA,CAACC,IAAI,EAAEV,IAAI,GAAG,OAAO,EAAE;EAC1C,IAAI;IACF,MAAMV,KAAK,GAAGC,MAAM,CAACC,eAAe;IACpC,IAAI,CAACF,KAAK,EAAE;IACZ,MAAMqB,KAAK,GAAG,IAAIC,wBAAwB,CAACF,IAAI,CAAC;IAChDC,KAAK,CAACX,IAAI,GAAGD,eAAe,CAACC,IAAI,CAAC;IAClC,MAAMa,KAAK,GAAGZ,aAAa,CAACD,IAAI,CAAC;IACjC,IAAIa,KAAK,EAAEF,KAAK,CAACE,KAAK,GAAGA,KAAK;IAC9BvB,KAAK,CAACwB,MAAM,CAAC,CAAC;IACdxB,KAAK,CAACmB,KAAK,CAACE,KAAK,CAAC;EACpB,CAAC,CAAC,OAAOf,CAAC,EAAE,CAAC;AACf;AAEA,OAAO,SAASmB,MAAMA,CAACC,QAAQ,EAAEC,OAAO,EAAE;EACxC,IAAI;IACF,MAAMC,iBAAiB,GAAG3B,MAAM,CAAC2B,iBAAiB,IAAI3B,MAAM,CAAC4B,uBAAuB;IACpF,IAAI,CAACD,iBAAiB,EAAE;MACtBD,OAAO,IAAIA,OAAO,CAAC,IAAIG,KAAK,CAAC,kCAAkC,CAAC,CAAC;MACjE,OAAO,MAAM,CAAC,CAAC;IACjB;IACA,MAAMC,WAAW,GAAG,IAAIH,iBAAiB,CAAC,CAAC;IAC3CG,WAAW,CAACrB,IAAI,GAAG,OAAO;IAC1BqB,WAAW,CAACC,UAAU,GAAG,KAAK;IAC9BD,WAAW,CAACE,cAAc,GAAG,KAAK;IAClCF,WAAW,CAACG,QAAQ,GAAIC,CAAC,IAAK;MAC5B,MAAMC,UAAU,GAAGD,CAAC,CAACE,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAACD,UAAU;MAC7CV,QAAQ,IAAIA,QAAQ,CAACU,UAAU,CAAC;IAClC,CAAC;IACDL,WAAW,CAACO,OAAO,GAAIH,CAAC,IAAKR,OAAO,IAAIA,OAAO,CAACQ,CAAC,CAAC;IAClDJ,WAAW,CAACQ,KAAK,CAAC,CAAC;IACnB,OAAO,MAAMR,WAAW,CAACS,IAAI,CAAC,CAAC;EACjC,CAAC,CAAC,OAAOL,CAAC,EAAE;IACVR,OAAO,IAAIA,OAAO,CAACQ,CAAC,CAAC;IACrB,OAAO,MAAM,CAAC,CAAC;EACjB;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}